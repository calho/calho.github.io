let hockeyApi=new HockeyAPI;function initiatePage(){fillTeamSelector(),fillPlayerSelector(!0),fillStatSelector(),createGraph()}function fillTeamSelector(){hockeyApi.getTeams()}function fillPlayerSelector(e=!1){let t=document.getElementById("teamSelector");document.getElementById("playerSelector").options.length=0,hockeyApi.getRoster(t.options[t.selectedIndex].value,e)}function fillStatSelector(){let e=document.getElementById("playerSelector"),t=e.options[e.selectedIndex],o=new JsonResponse;hockeyApi.getPlayerStats(t.value,o);let l=findNHLLeague(o.response.splits),n=document.getElementById("statSelector");n.options.length=0;for(let e in l.stat){let t=document.createElement("option");t.value=e,t.textContent=e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z])([A-Z])/g,"$1 $2").trim(),"points"===e&&(t.selected=!0),"savePercentage"===e&&(t.selected=!0),n.appendChild(t)}}function checkNHLLeague(e){return e.league.hasOwnProperty("id")&&e.league.id===hockeyApi.getNHLId()}function findNHLLeague(e){return e.find(checkNHLLeague)}function createGraph(){let e=document.getElementById("playerSelector"),t=new JsonResponse,o=[],l=[],n=[],a="",s=e.options[e.selectedIndex];hockeyApi.getPlayerStats(s.value,t);let i=t.response.splits;hockeyApi.getPlayerInformation(s.value,t);let r=t.response,c=document.getElementById("statSelector"),p=c.options[c.selectedIndex].value,d=c.options[c.selectedIndex].text;0===r.primaryPosition.code.localeCompare("G")?(i.forEach(function(e){if(e.league.hasOwnProperty("id")&&e.league.id===hockeyApi.getNHLId()){l.push(e.stat.savePercentage);let t=e.season;o.push(t.substring(0,4)+"-"+t.substring(4))}}),a=d):(i.forEach(function(e){if(e.league.hasOwnProperty("id")&&e.league.id===hockeyApi.getNHLId()&&e.stat.games>0){l.push(e.stat[p]/e.stat.games);let t=e.season;o.push(t.substring(0,4)+"-"+t.substring(4)),n.push(e.stat[p]+" "+d+" in "+e.stat.games+" games")}}),a=d+" Per Game");let g={x:o,y:l,text:n,name:s.text,type:"scatter"},u=Plotly.d3;document.getElementById("graph").remove();let y=u.select("#selectors").append("div").style({width:"60%","margin-left":"20%",height:"80vh","margin-top":"10vh"}).attr("id","graph").node(),m={showlegend:!0,legend:{x:100,y:1},xaxis:{title:"Season",titlefont:{family:"Courier New, monospace",size:18,color:"#7f7f7f"}},yaxis:{title:a,titlefont:{family:"Courier New, monospace",size:18,color:"#7f7f7f"}}},f=[g];Plotly.newPlot(y,f,m),window.onresize=function(){Plotly.Plots.resize(y)}}